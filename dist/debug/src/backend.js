!function i(a,c,s){function u(e,t){if(!c[e]){if(!a[e]){var n="function"==typeof require&&require;if(!t&&n)return n(e,!0);if(f)return f(e,!0);var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}var o=c[e]={exports:{}};a[e][0].call(o.exports,function(t){return u(a[e][1][t]||t)},o,o.exports,i,a,c,s)}return c[e].exports}for(var f="function"==typeof require&&require,t=0;t<s.length;t++)u(s[t]);return u}({1:[function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var a={};function o(){a.request("https://webapi.streamcraft.com/ucenter/follow/getLiveDataForPreview?_t="+ +new Date).then(function(t){if(!t.success)return!1;t.data.liveList.forEach(function(i){a.request("https://webapi.streamcraft.com/live/room/anchorinfo?_t="+ +new Date+"&uid="+i.scid).then(function(t){var e=a.getItem("streamSettings"),n=t.data.user.uin,r=e.find(function(t){return t.id===n}),o=t.data.user.show_id;(void 0===r||!0===r.notifications&&r.lastStream!==o)&&(createNotification({type:"image",title:i.nickName+" está ao vivo!",message:i.roomName,iconUrl:i.headImg,imageUrl:i.roomcover,url:"https://streamcraft.com/user/"+n,buttons:[{title:"Assistir",cb:function(){return window.open("https://streamcraft.com/user/"+n)}},{title:"Agora não",cb:function(){}}]}),void 0===r?e.push({id:n,notifications:!0,lastStream:o}):r.lastStream=o,a.setItem("streamSettings",e))})})})}a.isFirstRun=null===localStorage.getItem("streamSettings"),a.getItem=function(e){var n;try{n=JSON.parse(localStorage.getItem(e))}catch(t){n=localStorage.getItem(e)}return n},a.setItem=function(t,e){return localStorage.setItem(t,"object"===r(e)?JSON.stringify(e):e),!0},a.request=function(r){return new Promise(function(e,t){var n=new XMLHttpRequest;n.addEventListener("loadend",function(){var t=JSON.parse(n.responseText);e(t)}),n.xhrFields=!0,n.open("GET",r),n.setRequestHeader("Accept","application/json, text/plain, */*"),n.send()})},a.isFirstRun&&(localStorage.setItem("streamSettings","[]"),localStorage.setItem("config","{}")),chrome.runtime.onMessageExternal.addListener(function(t,e,n){if(-1===e.url.indexOf("streamcraft.com/")||!t.name)return!1;switch(t.name){case"setStorageItem":n(a.setItem(t.data.name,t.data.value));break;case"getStorageItem":n(a.getItem(t.data));break;case"createNotification":n(createNotification(t.data))}}),setInterval(function(){return o()},3e4),o();var i=[];function c(r){return new Promise(function(n,t){var e=new Image;e.crossOrigin="Anonymous",e.onload=function(){var t=document.createElement("CANVAS"),e=t.getContext("2d");t.height=this.naturalHeight,t.width=this.naturalWidth,e.drawImage(this,0,0),n(t.toDataURL())},e.src="https://images.weserv.nl/?url="+r+"&w=500",(e.complete||void 0===e.complete)&&e.onload()})}window.createNotification=function(n){c(n.iconUrl).then(function(t){return n.iconUrl=t,"image"===n.type?c(n.imageUrl):null}).then(function(t){null!==t&&(n.imageUrl=t);var e=Object.assign({},n);delete e.url,e.buttons=n.buttons?n.buttons.map(function(t){return{title:t.title}}):[];chrome.notifications.create(null,e,function(t){i.push({id:t,data:n})})})},chrome.notifications.onClicked.addListener(function(e){var t=i.find(function(t){return t.id===e});void 0!==t&&void 0!==t.data.url&&window.open(t.data.url)}),chrome.notifications.onButtonClicked.addListener(function(e,t){var n=i.find(function(t){return t.id===e});void 0!==n&&n.data.buttons[t].cb.call(n)})},{}]},{},[1]);